###############################
#######  連邦用イベント ########
###############################
namespace = ngm_federation
country_event = {
	id = ngm_federation.1
	hide_window = yes
	is_triggered_only = yes
	trigger = {
		exists = owner.federation
		owner.federation = {
			has_federation_perk = NGM_PU_TPP
		}
	}
	immediate = {
		every_owned_leader = {
			limit = {
				NOT = {
					has_leader_flag = flag_NGM_PU_TPP_bonus
				}
			}
			set_leader_flag = flag_NGM_PU_TPP_bonus
			set_skill = 2
		}
	}
}

#############################################
#######  バニライベント上書き用イベント ########
#############################################
namespace = syndaw
@recent_event_pause = 75
country_event = {
	id = syndaw.11
	hide_window = yes
	is_triggered_only = yes
	immediate = {
		random_list = {
			88 = {
				# 88% chance nothing happens
			}
			2 = {
				modifier = {
					# 50% chance if self preservation in effect
					has_active_tradition = tr_synchronicity_self_preservation
					factor = 0.5
				}
				modifier = {
					# 20% chance if civic_ngm_check in effect
					has_valid_civic = civic_ngm_check
					factor = 0.2
				}
				modifier = {
					# 50% chance if zro crystal edict is in effect
					has_edict = zro_crystal_machine
					factor = 0.5
				}
				modifier = {
					any_owned_leader = {
						leader_class = scientist
						exists = fleet
						species = {
							has_trait = trait_ngm_m_malfunction
						}
					}
					factor = 0.2
				}
				modifier = {
					any_owned_leader = {
						leader_class = scientist
						exists = fleet
						species = {
							has_trait = trait_ngm_m_incr
						}
					}
					factor = 0.15
				}
				modifier = {
					any_owned_leader = {
						leader_class = scientist
						exists = fleet
						species = {
							has_trait = trait_ngm_m_flash
						}
					}
					factor = 0.1
				}
				modifier = {
					any_owned_leader = {
						leader_class = scientist
						exists = fleet
						species = {
							has_trait = trait_ngm_m_blue
						}
					}
					factor = 0.1
				}
				modifier = {
					any_owned_leader = {
						leader_class = scientist
						exists = fleet
						species = {
							has_trait = trait_ngm_m_bomb
						}
					}
					factor = 0.05
				}
				modifier = {
					any_owned_leader = {
						leader_class = scientist
						exists = fleet
						species = {
							has_trait = trait_ngm_m_mcpu
						}
					}
					factor = 0.05
				}
				if = {
					# surveying scientist
					limit = {
						any_owned_leader = {
							leader_class = scientist
							exists = fleet
							species = {
								OR = {
									has_trait = trait_machine_unit
									has_trait = trait_mechanical
								}
							}
						}
					}
					random_owned_leader = {
						limit = {
							leader_class = scientist
							exists = fleet
							species = {
								OR = {
									has_trait = trait_machine_unit
									has_trait = trait_mechanical
								}
							}
						}
						# 20% chance if civic_ngm_check in effect
						if = {
							limit = {
								species = {
									OR = {
										has_trait = trait_ngm_m_malfunction
										has_trait = trait_ngm_m_main
										has_trait = trait_ngm_m_back
									}
								}
							}
							random_list = {
								99 = {
									save_event_target_as = malfunctioning_leader
									fleet = {
										save_event_target_as = malfunctioning_leader_fleet
									}
									root = {
										if = {
											limit = {
												has_authority = auth_machine_intelligence
											}
											country_event = {
												id = syndaw.21
											}
										}
										else = {
											country_event = {
												id = action.71
											}
										}
									}
									modifier = {
										any_owned_leader = {
											leader_class = scientist
											exists = fleet
											species = {
												has_trait = trait_ngm_m_main
											}
										}
										factor = 0.95
									}
									modifier = {
										any_owned_leader = {
											leader_class = scientist
											exists = fleet
											species = {
												has_trait = trait_ngm_m_made
											}
										}
										factor = 0.95
									}
									modifier = {
										any_owned_leader = {
											leader_class = scientist
											exists = fleet
											species = {
												has_trait = trait_ngm_m_back
											}
										}
										factor = 0.8
									}
								}
								1 = {
								}
							}
						}
						else = {
							save_event_target_as = malfunctioning_leader
							fleet = {
								save_event_target_as = malfunctioning_leader_fleet
							}
							root = {
								if = {
									limit = {
										has_authority = auth_machine_intelligence
									}
									country_event = {
										id = syndaw.21
									}
								}
								else = {
									country_event = {
										id = action.71
									}
								}
							}
						}
					}
				}
			}
			2 = {
				modifier = {
					# 50% chance if self preservation in effect
					has_active_tradition = tr_synchronicity_self_preservation
					factor = 0.5
				}
				modifier = {
					# 2% chance if civic_ngm_check in effect
					has_valid_civic = civic_ngm_check
					factor = 0.2
				}
				modifier = {
					# 50% chance if zro crystal edict is in effect
					has_edict = zro_crystal_machine
					factor = 0.5
				}
				modifier = {
					any_owned_leader = {
						leader_class = scientist
						is_researching_area = engineering
						species = {
							has_trait = trait_ngm_m_malfunction
						}
					}
					factor = 0.2
				}
				modifier = {
					any_owned_leader = {
						leader_class = scientist
						is_researching_area = engineering
						species = {
							has_trait = trait_ngm_m_incr
						}
					}
					factor = 0.15
				}
				modifier = {
					any_owned_leader = {
						leader_class = scientist
						is_researching_area = engineering
						species = {
							has_trait = trait_ngm_m_flash
						}
					}
					factor = 0.1
				}
				modifier = {
					any_owned_leader = {
						leader_class = scientist
						is_researching_area = engineering
						species = {
							has_trait = trait_ngm_m_blue
						}
					}
					factor = 0.1
				}
				modifier = {
					any_owned_leader = {
						leader_class = scientist
						is_researching_area = engineering
						species = {
							has_trait = trait_ngm_m_bomb
						}
					}
					factor = 0.05
				}
				modifier = {
					any_owned_leader = {
						leader_class = scientist
						is_researching_area = engineering
						species = {
							has_trait = trait_ngm_m_mcpu
						}
					}
					factor = 0.05
				}
				if = {
					# engineering scientist
					limit = {
						any_owned_leader = {
							leader_class = scientist
							is_researching_area = engineering
							species = {
								OR = {
									has_trait = trait_machine_unit
									has_trait = trait_mechanical
								}
							}
						}
					}
					random_owned_leader = {
						limit = {
							leader_class = scientist
							is_researching_area = engineering
							species = {
								OR = {
									has_trait = trait_machine_unit
									has_trait = trait_mechanical
								}
							}
						}
						# 20% chance if civic_ngm_check in effect
						if = {
							limit = {
								species = {
									OR = {
										has_trait = trait_ngm_m_malfunction
										has_trait = trait_ngm_m_main
										has_trait = trait_ngm_m_back
									}
								}
							}
							random_list = {
								99 = {
									save_event_target_as = malfunctioning_leader
									root = {
										if = {
											limit = {
												has_authority = auth_machine_intelligence
											}
											country_event = {
												id = syndaw.22
											}
										}
										else = {
											country_event = {
												id = action.72
											}
										}
									}
									modifier = {
										any_owned_leader = {
											leader_class = scientist
											is_researching_area = engineering
											species = {
												has_trait = trait_ngm_m_main
											}
										}
										factor = 0.95
									}
									modifier = {
										any_owned_leader = {
											leader_class = scientist
											is_researching_area = engineering
											species = {
												has_trait = trait_ngm_m_made
											}
										}
										factor = 0.95
									}
									modifier = {
										any_owned_leader = {
											leader_class = scientist
											is_researching_area = engineering
											species = {
												has_trait = trait_ngm_m_back
											}
										}
										factor = 0.8
									}
								}
								1 = {
								}
							}
						}
						else = {
							save_event_target_as = malfunctioning_leader
							root = {
								if = {
									limit = {
										has_authority = auth_machine_intelligence
									}
									country_event = {
										id = syndaw.22
									}
								}
								else = {
									country_event = {
										id = action.72
									}
								}
							}
						}
					}
				}
			}
			2 = {
				modifier = {
					# 50% chance if self preservation in effect
					has_active_tradition = tr_synchronicity_self_preservation
					factor = 0.5
				}
				modifier = {
					# 2% chance if civic_ngm_check in effect
					has_valid_civic = civic_ngm_check
					factor = 0.2
				}
				modifier = {
					# 50% chance if zro crystal edict is in effect
					has_edict = zro_crystal_machine
					factor = 0.5
				}
				modifier = {
					any_owned_leader = {
						leader_class = scientist
						is_researching_area = society
						species = {
							has_trait = trait_ngm_m_malfunction
						}
					}
					factor = 0.2
				}
				modifier = {
					any_owned_leader = {
						leader_class = scientist
						is_researching_area = society
						species = {
							has_trait = trait_ngm_m_incr
						}
					}
					factor = 0.15
				}
				modifier = {
					any_owned_leader = {
						leader_class = scientist
						is_researching_area = society
						species = {
							has_trait = trait_ngm_m_flash
						}
					}
					factor = 0.1
				}
				modifier = {
					any_owned_leader = {
						leader_class = scientist
						is_researching_area = society
						species = {
							has_trait = trait_ngm_m_blue
						}
					}
					factor = 0.1
				}
				modifier = {
					any_owned_leader = {
						leader_class = scientist
						is_researching_area = society
						species = {
							has_trait = trait_ngm_m_bomb
						}
					}
					factor = 0.05
				}
				modifier = {
					any_owned_leader = {
						leader_class = scientist
						is_researching_area = society
						species = {
							has_trait = trait_ngm_m_mcpu
						}
					}
					factor = 0.05
				}
				if = {
					# society scientist
					limit = {
						any_owned_leader = {
							leader_class = scientist
							is_researching_area = society
							species = {
								OR = {
									has_trait = trait_machine_unit
									has_trait = trait_mechanical
								}
							}
						}
					}
					random_owned_leader = {
						limit = {
							leader_class = scientist
							is_researching_area = society
							species = {
								OR = {
									has_trait = trait_machine_unit
									has_trait = trait_mechanical
								}
							}
						}
						# 20% chance if civic_ngm_check in effect
						if = {
							limit = {
								species = {
									OR = {
										has_trait = trait_ngm_m_malfunction
										has_trait = trait_ngm_m_main
										has_trait = trait_ngm_m_back
									}
								}
							}
							random_list = {
								99 = {
									save_event_target_as = malfunctioning_leader
									root = {
										if = {
											limit = {
												has_authority = auth_machine_intelligence
											}
											country_event = {
												id = syndaw.23
											}
										}
										else = {
											country_event = {
												id = action.73
											}
										}
									}
									modifier = {
										any_owned_leader = {
											leader_class = scientist
											is_researching_area = society
											species = {
												has_trait = trait_ngm_m_main
											}
										}
										factor = 0.95
									}
									modifier = {
										any_owned_leader = {
											leader_class = scientist
											is_researching_area = society
											species = {
												has_trait = trait_ngm_m_made
											}
										}
										factor = 0.95
									}
									modifier = {
										any_owned_leader = {
											leader_class = scientist
											is_researching_area = society
											species = {
												has_trait = trait_ngm_m_back
											}
										}
										factor = 0.8
									}
								}
								1 = {
								}
							}
						}
						else = {
							save_event_target_as = malfunctioning_leader
							root = {
								if = {
									limit = {
										has_authority = auth_machine_intelligence
									}
									country_event = {
										id = syndaw.23
									}
								}
								else = {
									country_event = {
										id = action.73
									}
								}
							}
						}
					}
				}
			}
			2 = {
				modifier = {
					# 50% chance if self preservation in effect
					has_active_tradition = tr_synchronicity_self_preservation
					factor = 0.5
				}
				modifier = {
					# 2% chance if civic_ngm_check in effect
					has_valid_civic = civic_ngm_check
					factor = 0.2
				}
				modifier = {
					any_owned_leader = {
						leader_class = scientist
						is_researching_area = physics
						species = {
							has_trait = trait_ngm_m_malfunction
						}
					}
					factor = 0.2
				}
				modifier = {
					any_owned_leader = {
						leader_class = scientist
						is_researching_area = physics
						species = {
							has_trait = trait_ngm_m_incr
						}
					}
					factor = 0.15
				}
				modifier = {
					any_owned_leader = {
						leader_class = scientist
						is_researching_area = physics
						species = {
							has_trait = trait_ngm_m_flash
						}
					}
					factor = 0.1
				}
				modifier = {
					any_owned_leader = {
						leader_class = scientist
						is_researching_area = physics
						species = {
							has_trait = trait_ngm_m_blue
						}
					}
					factor = 0.1
				}
				modifier = {
					any_owned_leader = {
						leader_class = scientist
						is_researching_area = physics
						species = {
							has_trait = trait_ngm_m_bomb
						}
					}
					factor = 0.05
				}
				modifier = {
					any_owned_leader = {
						leader_class = scientist
						is_researching_area = physics
						species = {
							has_trait = trait_ngm_m_mcpu
						}
					}
					factor = 0.05
				}
				if = {
					# society scientist
					limit = {
						any_owned_leader = {
							leader_class = scientist
							is_researching_area = physics
							species = {
								OR = {
									has_trait = trait_machine_unit
									has_trait = trait_mechanical
								}
							}
						}
					}
					random_owned_leader = {
						limit = {
							leader_class = scientist
							is_researching_area = physics
							species = {
								OR = {
									has_trait = trait_machine_unit
									has_trait = trait_mechanical
								}
							}
						}
						# 20% chance if civic_ngm_check in effect
						if = {
							limit = {
								species = {
									OR = {
										has_trait = trait_ngm_m_malfunction
										has_trait = trait_ngm_m_main
										has_trait = trait_ngm_m_back
									}
								}
							}
							random_list = {
								99 = {
									save_event_target_as = malfunctioning_leader
									root = {
										if = {
											limit = {
												has_authority = auth_machine_intelligence
											}
											country_event = {
												id = syndaw.24
											}
										}
										else = {
											country_event = {
												id = action.74
											}
										}
									}
									modifier = {
										any_owned_leader = {
											leader_class = scientist
											is_researching_area = physics
											species = {
												has_trait = trait_ngm_m_main
											}
										}
										factor = 0.95
									}
									modifier = {
										any_owned_leader = {
											leader_class = scientist
											is_researching_area = physics
											species = {
												has_trait = trait_ngm_m_made
											}
										}
										factor = 0.95
									}
									modifier = {
										any_owned_leader = {
											leader_class = scientist
											is_researching_area = physics
											species = {
												has_trait = trait_ngm_m_back
											}
										}
										factor = 0.8
									}
								}
								1 = {
								}
							}
						}
						else = {
							save_event_target_as = malfunctioning_leader
							root = {
								if = {
									limit = {
										has_authority = auth_machine_intelligence
									}
									country_event = {
										id = syndaw.24
									}
								}
								else = {
									country_event = {
										id = action.74
									}
								}
							}
						}
					}
				}
			}
			2 = {
				modifier = {
					# 50% chance if self preservation in effect
					has_active_tradition = tr_synchronicity_self_preservation
					factor = 0.5
				}
				modifier = {
					# 2% chance if civic_ngm_check in effect
					has_valid_civic = civic_ngm_check
					factor = 0.2
				}
				modifier = {
					any_owned_leader = {
						leader_class = admiral
						exists = fleet
						species = {
							has_trait = trait_ngm_m_malfunction
						}
					}
					factor = 0.2
				}
				modifier = {
					any_owned_leader = {
						leader_class = admiral
						exists = fleet
						species = {
							has_trait = trait_ngm_m_incr
						}
					}
					factor = 0.15
				}
				modifier = {
					any_owned_leader = {
						leader_class = admiral
						exists = fleet
						species = {
							has_trait = trait_ngm_m_flash
						}
					}
					factor = 0.1
				}
				modifier = {
					any_owned_leader = {
						leader_class = admiral
						exists = fleet
						species = {
							has_trait = trait_ngm_m_blue
						}
					}
					factor = 0.1
				}
				modifier = {
					any_owned_leader = {
						leader_class = admiral
						exists = fleet
						species = {
							has_trait = trait_ngm_m_bomb
						}
					}
					factor = 0.05
				}
				modifier = {
					any_owned_leader = {
						leader_class = admiral
						exists = fleet
						species = {
							has_trait = trait_ngm_m_mcpu
						}
					}
					factor = 0.05
				}
				if = {
					# commanding admiral
					limit = {
						any_owned_leader = {
							leader_class = admiral
							exists = fleet
							species = {
								OR = {
									has_trait = trait_machine_unit
									has_trait = trait_mechanical
								}
							}
						}
					}
					random_owned_leader = {
						limit = {
							leader_class = admiral
							exists = fleet
							species = {
								OR = {
									has_trait = trait_machine_unit
									has_trait = trait_mechanical
								}
							}
						}
						# 20% chance if civic_ngm_check in effect
						if = {
							limit = {
								species = {
									OR = {
										has_trait = trait_ngm_m_malfunction
										has_trait = trait_ngm_m_main
										has_trait = trait_ngm_m_back
									}
								}
							}
							random_list = {
								99 = {
									save_event_target_as = malfunctioning_leader
									fleet = {
										save_event_target_as = malfunctioning_leader_fleet
									}
									root = {
										if = {
											limit = {
												has_authority = auth_machine_intelligence
											}
											country_event = {
												id = syndaw.25
											}
										}
										else = {
											country_event = {
												id = action.75
											}
										}
									}
									modifier = {
										any_owned_leader = {
											leader_class = admiral
											exists = fleet
											species = {
												has_trait = trait_ngm_m_main
											}
										}
										factor = 0.95
									}
									modifier = {
										any_owned_leader = {
											leader_class = admiral
											exists = fleet
											species = {
												has_trait = trait_ngm_m_made
											}
										}
										factor = 0.95
									}
									modifier = {
										any_owned_leader = {
											leader_class = admiral
											exists = fleet
											species = {
												has_trait = trait_ngm_m_back
											}
										}
										factor = 0.8
									}
								}
								1 = {
								}
							}
						}
						else = {
							save_event_target_as = malfunctioning_leader
							fleet = {
								save_event_target_as = malfunctioning_leader_fleet
							}
							root = {
								if = {
									limit = {
										has_authority = auth_machine_intelligence
									}
									country_event = {
										id = syndaw.25
									}
								}
								else = {
									country_event = {
										id = action.75
									}
								}
							}
						}
					}
				}
			}
			2 = {
				modifier = {
					# 50% chance if self preservation in effect
					has_active_tradition = tr_synchronicity_self_preservation
					factor = 0.5
				}
				modifier = {
					# 2% chance if civic_ngm_check in effect
					has_valid_civic = civic_ngm_check
					factor = 0.2
				}
				modifier = {
					# 50% chance if zro crystal edict is in effect
					has_edict = zro_crystal_machine
					factor = 0.5
				}
				modifier = {
					any_owned_leader = {
						leader_class = governor
						exists = sector
						species = {
							has_trait = trait_ngm_m_malfunction
						}
					}
					factor = 0.2
				}
				modifier = {
					any_owned_leader = {
						leader_class = governor
						exists = sector
						species = {
							has_trait = trait_ngm_m_incr
						}
					}
					factor = 0.15
				}
				modifier = {
					any_owned_leader = {
						leader_class = governor
						exists = sector
						species = {
							has_trait = trait_ngm_m_flash
						}
					}
					factor = 0.1
				}
				modifier = {
					any_owned_leader = {
						leader_class = governor
						exists = sector
						species = {
							has_trait = trait_ngm_m_blue
						}
					}
					factor = 0.1
				}
				modifier = {
					any_owned_leader = {
						leader_class = governor
						exists = sector
						species = {
							has_trait = trait_ngm_m_bomb
						}
					}
					factor = 0.05
				}
				modifier = {
					any_owned_leader = {
						leader_class = governor
						exists = sector
						species = {
							has_trait = trait_ngm_m_mcpu
						}
					}
					factor = 0.05
				}
				if = {
					# planet governor
					limit = {
						any_owned_leader = {
							leader_class = governor
							exists = sector
							species = {
								OR = {
									has_trait = trait_machine_unit
									has_trait = trait_mechanical
								}
							}
						}
					}
					random_owned_leader = {
						limit = {
							leader_class = governor
							exists = sector
							species = {
								OR = {
									has_trait = trait_machine_unit
									has_trait = trait_mechanical
								}
							}
						}
						# 20% chance if civic_ngm_check in effect
						if = {
							limit = {
								species = {
									OR = {
										has_trait = trait_ngm_m_malfunction
										has_trait = trait_ngm_m_main
										has_trait = trait_ngm_m_back
									}
								}
							}
							random_list = {
								99 = {
									save_event_target_as = malfunctioning_leader
									root = {
										if = {
											limit = {
												has_authority = auth_machine_intelligence
											}
											country_event = {
												id = syndaw.26
											}
										}
										else = {
											country_event = {
												id = action.76
											}
										}
									}
									modifier = {
										any_owned_leader = {
											leader_class = governor
											exists = sector
											species = {
												has_trait = trait_ngm_m_main
											}
										}
										factor = 0.95
									}
									modifier = {
										any_owned_leader = {
											leader_class = governor
											exists = sector
											species = {
												has_trait = trait_ngm_m_made
											}
										}
										factor = 0.95
									}
									modifier = {
										any_owned_leader = {
											leader_class = governor
											exists = sector
											species = {
												has_trait = trait_ngm_m_back
											}
										}
										factor = 0.8
									}
								}
								1 = {
								}
							}
						}
						else = {
							save_event_target_as = malfunctioning_leader
							root = {
								if = {
									limit = {
										has_authority = auth_machine_intelligence
									}
									country_event = {
										id = syndaw.26
									}
								}
								else = {
									country_event = {
										id = action.76
									}
								}
							}
						}
					}
				}
			}
		}
	}
}
